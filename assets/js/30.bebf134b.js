(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{218:function(t,e,a){"use strict";a.r(e);var r=a(0),o=Object(r.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"与-umi-antd-pro-一起使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#与-umi-antd-pro-一起使用"}},[t._v("#")]),t._v(" 与 umi/antd-pro 一起使用")]),t._v(" "),a("div",{staticClass:"lake-content-editor-core lake-engine",attrs:{"data-lake-element":"root","data-selection-236311":"%7B%22path%22%3A%5B%5B28%2C1%5D%2C%5B28%2C1%5D%5D%2C%22uuid%22%3A%22236311%22%2C%22active%22%3Atrue%7D"}},[a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("部分 "),a("code",[t._v("umi")]),t._v(" 和 "),a("code",[t._v("antd pro")]),t._v(" 的用户在的静态资源需要单独发布，然后通过 "),a("code",[t._v("js")]),t._v(" 引用到后端的页面上。")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("如果我们需要在本地开发时把 "),a("code",[t._v("js")]),t._v(" 直接联调到线上的页面，需要把线上的地址代理到本地，但是会碰到一些问题（例如 "),a("code",[t._v("HMR")]),t._v(" ， "),a("code",[t._v("common.js")]),t._v(" 等），所以写个文档专门介绍下怎么使用。")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),t._v(" "),a("h3",{attrs:{id:"转发文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#转发文件"}},[t._v("#")]),t._v(" 转发文件")]),t._v(" "),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("举个例子，我们有一个后端页面， "),a("code",[t._v("js/css")]),t._v(" 被我们发到 "),a("code",[t._v("g.alicdn.com")])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("假设我们的这个页面域名为 "),a("code",[t._v("www.test.com")]),t._v(" ，在页面上引用了 ")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"8yDsc"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(38, 38, 38)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("g"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alicdn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ife"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("project"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("umi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("css\nhttps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("g"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alicdn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ife"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("project"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("umi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js \n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("两个托管在 CDN 上的 "),a("code",[t._v("css")]),t._v(" 和 "),a("code",[t._v("js")]),t._v(" 。")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("但是单纯的转发这两个文件是不够的的，因为在本地开发时， "),a("code",[t._v("umi")]),t._v(" 还会提供 "),a("code",[t._v("HMR")]),t._v(" ，异步加载， "),a("code",[t._v("vendor")]),t._v(" 等功能，我们需要把这些东西也转发过去。")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("所以对应的规则为：")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"WYBVS"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(38, 38, 38)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("# 代理两个主要文件，根据具体的 "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL")]),t._v(" 修改\ng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alicdn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ife"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("project"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("umi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("css http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/127.0.0.1:8000/umi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("css\ng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alicdn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ife"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("project"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("umi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/127.0.0.1:8000/umi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js\n\n# 本地开发的异步加载的 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" js"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("css 和 vendor 等都会从 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" 加载，所以要做相应的转发\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),t._v("www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/***.js http://127.0.0.1:8000/$1.js\n^www.test.com/***.map http://127.0.0.1:8000/$1.map\n^www.test.com/***.css http://127.0.0.1:8000/$1.css\n\n# /socksjs-node/ 是 HMR 功能使用的，要把下面的 ws/xhr 做转发\n^www.test.com/sockjs-node/*** http://127.0.0.1:8000/sockjs-node/$1\n\n# :3000/ 的转发是 umi-ui 使用的接口，同样转发过去\nwww.test.com:3000 http://127.0.0.1:3000/\n\n# 一般来说这一条是不需要的，因为线上的 API 往往是直接走线上的 API 就可以，但是如果需要的话可以加上\n# 把 API 转发到本地\n# ^www.test.com/api/*** http://127.0.0.1:8000/api/$1 \n")])])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),t._v(" "),a("h3",{attrs:{id:"注意"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意"}},[t._v("#")]),t._v(" 注意")]),t._v(" "),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("上面的端口号和域名可能需要根据实际情况做一些改变。")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),t._v(" "),a("h2",{attrs:{id:"预览"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#预览"}},[t._v("#")]),t._v(" 预览")]),t._v(" "),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("修改一下 "),a("code",[t._v("Welcome.jsx")]),t._v(" 页面能够进行 "),a("code",[t._v("Hot reload")])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("span",{attrs:{"data-card-type":"inline","data-lake-card":"image"}},[a("img",{staticClass:"image lake-drag-image",staticStyle:{visibility:"visible",border:"none","box-shadow":"none",width:"746px",height:"392px"},attrs:{"data-role":"image",src:"https://cdn.nlark.com/yuque/0/2020/png/236311/1578558834742-78f3a926-d1b8-4ed0-9b95-2b76f27a2468.png?x-oss-process=image/resize,w_1500","data-raw-src":"https://cdn.nlark.com/yuque/0/2020/png/236311/1578558834742-78f3a926-d1b8-4ed0-9b95-2b76f27a2468.png",alt:"image.png",title:"image.png"}})])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")])]),a("br"),a("br"),a("a",{staticClass:"yuque-link",attrs:{target:"_blank",href:"https://www.yuque.com/lp/doc/use-with-umi-antd-pro"}},[a("svg",{attrs:{viewBox:"64 64 896 896","data-icon":"yuque",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"}},[a("path",{attrs:{d:"M854.6 370.6c-9.9-39.4 9.9-102.2 73.4-124.4l-67.9-3.6s-25.7-90-143.6-98c-117.8-8.1-194.9-3-195-3 .1 0 87.4 55.6 52.4 154.7-25.6 52.5-65.8 95.6-108.8 144.7-1.3 1.3-2.5 2.6-3.5 3.7C319.4 605 96 860 96 860c245.9 64.4 410.7-6.3 508.2-91.1 20.5-.2 35.9-.3 46.3-.3 135.8 0 250.6-117.6 245.9-248.4-3.2-89.9-31.9-110.2-41.8-149.6zm-204.1 334c-10.6 0-26.2.1-46.8.3l-23.6.2-17.8 15.5c-47.1 41-104.4 71.5-171.4 87.6-52.5 12.6-110 16.2-172.7 9.6 18-20.5 36.5-41.6 55.4-63.1 92-104.6 173.8-197.5 236.9-268.5l1.4-1.4 1.3-1.5c4.1-4.6 20.6-23.3 24.7-28.1 9.7-11.1 17.3-19.9 24.5-28.6 30.7-36.7 52.2-67.8 69-102.2l1.6-3.3 1.2-3.4c13.7-38.8 15.4-76.9 6.2-112.8 22.5.7 46.5 1.9 71.7 3.6 33.3 2.3 55.5 12.9 71.1 29.2 5.8 6 10.2 12.5 13.4 18.7 1 2 1.7 3.6 2.3 5l5 17.7c-15.7 34.5-19.9 73.3-11.4 107.2 3 11.8 6.9 22.4 12.3 34.4 2.1 4.7 9.5 20.1 11 23.3 10.3 22.7 15.4 43 16.7 78.7 3.3 94.6-82.7 181.9-182 181.9z"}})]),t._v(" 使用语雀查看")])])}),[],!1,null,null,null);e.default=o.exports}}]);